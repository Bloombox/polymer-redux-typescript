<head>
    <link rel="import" href="../decorators.html">
    <link rel="import" href="../../bower_components/polymer/polymer-element.html">
    <link rel="import" href="../../bower_components/iron-list/iron-list.html">
    <link rel="import" href="../../bower_components/iron-scroll-threshold/iron-scroll-threshold.html">
    <link rel="import" href="../../bower_components/paper-item/paper-item.html">
    <link rel="import" href="../../bower_components/paper-button/paper-button.html">

    <link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
    <link rel="import" href="../../bower_components/paper-tabs/paper-tab.html">
    <link rel="import" href="../../bower_components/iron-pages/iron-pages.html">


    <link rel="import" href="../ozone-item-api/ozone-item-api.html">
    <link rel="import" href="../ozone-item-preview/ozone-item-preview.html">
    <link rel="import" href="../ozone-item-view/ozone-item-view.html">
    <link rel="import" href="../ozone-collection/ozone-collection.html">
    <link rel="import" href="../ozone-item-view-factory/ozone-item-view-factory.html">
    <link rel="import" href="../ozone-media-edit/ozone-media-edit.html">

</head>
<body>
<dom-module id="ozone-mosaic">
    <template>
        <style>
            iron-scroll-threshold {
                top: 10vh;
                left: 25vh;
                right: 25vh;
                height: 40vh;
                text-align: center;
                box-shadow: 0 0 60px rgba(0,0,0,0.5);
            }
            .loader {
                background-color: #0b8043;
                text-align: center;
                height: 44px;
                font: 13px arial;
                line-height: 44px;
                color: white;
            }
            .resultList {
            }
            .resultListItem {
            }

        </style>
        <ozone-collection
                id="mosaicCollection"
                items="{{items}}"
                total="{{total}}"
                data-remain="{{dataRemain}}"></ozone-collection>

        <div hidden$="[[!items.length]]">
        <iron-scroll-threshold id="scrollTheshold" on-lower-threshold="toggleThreshold"  >
            <div class="resultList">
            <iron-list scroll-target="scrollTheshold" items="[[items]]"selected-item="{{selectedItem}}" selection-enabled>
                <template>
                    <ozone-item-preview  ozone-type-api-id="ozoneApiType" item-id="[[item.id]]" item-data="[[item]]" class="resultListItem"></ozone-item-preview>
                </template>
            </iron-list>
            <paper-item class="loader" hidden$="[[!dataRemain]]">Fetching new items...</paper-item>
            </div>
        </iron-scroll-threshold>
        </div>
        <paper-tabs selected="{{selectedAction}}" scrollable>
            <paper-tab>View</paper-tab>
            <paper-tab>Edit</paper-tab>
        </paper-tabs>
        <iron-pages selected="{{selectedAction}}">
            <div>
                <ozone-item-view-factory item="[[selectedItem]]"></ozone-item-view-factory>
            </div>
            <div>
                <paper-button raised id="saveBtn" on-tap="saveSelectedItem">Save</paper-button>
                <ozone-media-edit id="mediaEditor" item-data={{selectedItem}}></ozone-media-edit>
            </div>
        </iron-pages>
    </template>
    <script src="ozone-mosaic.js"></script>
</dom-module>
</body>